<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Транссибирская магистраль — встроенные координаты</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body { margin: 0; padding: 0; height: 100%; }
    #map { width: 100%; height: 100vh; }
    .leaflet-control-attribution {
    display: none !important;
  }
  </style>
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([56, 90], 4);

  const bounds = L.latLngBounds([40, 30], [75, 140]);
  map.setMaxBounds(bounds);
  map.on('drag', function() {
    map.panInsideBounds(bounds, { animate: false });
  });

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  L.tileLayer('https://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png', {
    attribution: '© OpenRailwayMap contributors'
  }).addTo(map);

  // Встроенный GeoJSON с маршрутом
  const geojson = {"type": "Feature", "properties": {"name": "Транссибирская магистраль (все станции)"}, "geometry": {"type": "LineString", "coordinates": [[37.6558, 55.7769], [38.1333, 56.3], [38.7167, 56.4], [39.4167, 57.2], [39.85, 57.6167], [40.1667, 58.2], [40.6833, 58.3667], [41.5333, 58.4833], [42.3667, 58.3833], [43.0, 58.4], [43.5, 58.5], [43.8667, 58.2833], [44.7667, 58.3167], [45.5167, 58.3667], [46.2667, 58.6333], [47.0, 58.9], [47.6333, 58.9333], [48.3333, 58.3], [48.9, 58.4], [49.0667, 58.6], [49.65, 58.6], [50.0, 58.4], [50.3167, 58.3833], [50.7, 58.25], [52.65, 58.1333], [53.0, 57.9833], [53.7, 57.9], [54.9667, 57.5667], [55.0, 57.15], [56.25, 58.0], [56.9333, 57.4333], [57.5, 57.0], [58.0, 56.95], [59.95, 56.9], [60.6, 56.85], [61.0, 56.8], [61.5, 56.75], [62.05, 56.7833], [62.5, 56.7], [62.7167, 56.85], [63.0, 56.9], [63.7333, 56.9], [64.2, 56.9], [64.6, 56.9], [65.5333, 57.15], [66.3, 56.65], [66.55, 56.5], [67.0, 56.45], [68.0, 56.4], [69.5, 56.1], [70.1167, 56.1333], [70.3667, 56.2833], [72.65, 55.5667], [74.6667, 55.15], [73.3667, 54.9833], [74.5667, 55.2333], [75.9833, 55.2167], [76.7667, 55.3167], [77.0, 55.3833], [77.5, 55.5], [78.3667, 55.35], [78.8333, 55.3167], [80.2833, 55.2], [80.95, 55.1], [82.7, 55.0333], [82.9167, 55.0333], [84.4, 55.6667], [84.95, 55.7167], [85.6167, 56.0667], [86.0333, 56.0833], [86.4333, 56.2], [87.75, 56.2167], [88.5167, 56.1167], [89.5333, 56.2], [90.5, 56.2667], [91.0, 56.25], [91.2, 56.3], [92.8667, 56.0167], [94.3167, 55.8], [94.7, 55.95], [95.1, 55.9333], [95.7, 56.2], [96.0667, 56.2333], [96.5, 56.2667], [98.0, 55.9333], [98.6667, 55.55], [99.0333, 54.9], [100.5667, 54.5667], [101.5, 54.3333], [102.05, 53.9333], [102.5, 53.7], [103.0667, 53.15], [103.6333, 52.7667], [103.8667, 52.5667], [104.2833, 52.2833], [104.1, 52.2], [103.7167, 51.6667], [104.1333, 51.5167], [105.1333, 51.6], [105.8667, 51.7167], [106.5, 51.75], [107.6167, 51.8333], [108.0, 51.6667], [108.8333, 51.2667], [109.4, 51.1], [110.5, 51.3333], [111.0, 51.45], [111.6667, 51.7333], [112.5, 51.75], [113.5, 52.0333], [114.0, 52.2667], [114.55, 52.3667], [115.0, 52.5], [116.0333, 51.85], [113.5, 52.0333], [113.9667, 52.15], [117.0167, 52.5167], [118.3333, 52.7833], [119.6, 52.9333], [119.7667, 53.7333], [121.6, 53.9], [123.9333, 53.9667], [125.0, 54.0], [126.0, 54.2], [123.9167, 54.0], [124.9333, 53.9333], [125.8, 53.45], [126.5667, 53.2667], [127.7, 52.0], [128.1333, 51.3833], [128.4833, 50.9167], [129.4333, 50.1167], [129.8167, 49.8167], [130.0833, 49.4167], [131.05, 49.0167], [131.55, 48.9333], [132.0, 48.9], [132.9333, 48.7833], [133.8, 48.6], [135.0833, 48.4833], [135.5, 48.4], [134.75, 47.5333], [134.25, 46.8167], [134.2833, 46.9667], [133.7333, 45.9333], [133.4333, 45.9], [133.9, 45.45], [132.8167, 44.6], [132.75, 44.4667], [131.95, 43.8], [132.0, 43.5], [131.8833, 43.1167]]}};

  let route;

    function showRoute() {
      if (!route) {
        route = L.geoJSON(geojson, {
          style: {
            color: "#0000FF",
            weight: 4,
            opacity: 0.9
          }
        }).addTo(map);
        map.fitBounds(route.getBounds());
      }
    }

    function hideRoute() {
      if (route) {
        map.removeLayer(route);
        route = null;
      }
    }

    window.addEventListener('message', (event) => {
      if (event.data === 'toggleRoute') {
        if (route) {
          hideRoute();
        } else {
          showRoute();
        }
      }
    });
</script>

</body>
</html>